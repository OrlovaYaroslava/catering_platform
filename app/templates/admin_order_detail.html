{% extends "base.html" %}

{% block title %}–ó–∞–∫–∞–∑ ‚Ññ{{ order.id }}{% endblock %}

{% block content %}
<h2>–ó–∞–∫–∞–∑ ‚Ññ{{ order.id }}</h2>

<!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ó–ê–ö–ê–ó–ï -->
<div class="card">
    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ</h3>

    <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> {{ order.user.email }}</p>
    <p><strong>–î–∞—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:</strong> {{ order.event_date }}</p>
    <p><strong>–í—Ä–µ–º—è:</strong> {{ order.event_time }}</p>
    <p><strong>–ê–¥—Ä–µ—Å:</strong> {{ order.address }}</p>
    <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π:</strong> {{ order.guests_count }}</p>

    <p>
        <strong>–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞:</strong>
        {% if order.status == "awaiting_payment" %}
            üïí –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
        {% elif order.status == "paid" %}
            üü° –û–ø–ª–∞—á–µ–Ω (–æ–∂–∏–¥–∞–µ—Ç –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è)
        {% elif order.status == "cooking" %}
            üî• –í —Ä–∞–±–æ—Ç–µ
        {% elif order.status == "ready" %}
            ‚úÖ –ì–æ—Ç–æ–≤
        {% else %}
            {{ order.status }}
        {% endif %}
    </p>
</div>

<!-- –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –î–õ–Ø –ö–£–•–ù–ò -->
<div class="card">
    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∫—É—Ö–Ω–∏</h3>

    <form method="POST"
          action="{{ url_for('main.admin_update_kitchen_comment', order_id=order.id) }}">

        <textarea name="kitchen_comment" rows="4" style="width:100%;">
{{ order.kitchen_comment or "" }}
        </textarea>

        <br><br>

        <label>
            <input type="checkbox" name="is_urgent"
                {% if order.is_urgent %}checked{% endif %}>
            –°—Ä–æ—á–Ω—ã–π –∑–∞–∫–∞–∑
        </label>

        <br><br>

        <button class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>
</div>


<!-- –°–û–°–¢–ê–í –ó–ê–ö–ê–ó–ê -->
<div class="card">
    <h3>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</h3>

    {% for item in items %}
        <div style="margin-bottom: 10px;">
            <strong>{{ item.dish.name }}</strong><br>
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {{ item.quantity }} —à—Ç.<br>
            –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: {{ item.price }} ‚ÇΩ<br>

            {% if item.dish.is_vegan %}
                üå± –í–µ–≥–∞–Ω—Å–∫–æ–µ<br>
            {% endif %}
            {% if item.dish.is_gluten_free %}
                üö´ –ë–µ–∑ –≥–ª—é—Ç–µ–Ω–∞<br>
            {% endif %}
            {% if item.dish.contains_allergens %}
                ‚ö†Ô∏è –°–æ–¥–µ—Ä–∂–∏—Ç –∞–ª–ª–µ—Ä–≥–µ–Ω—ã<br>
            {% endif %}
        </div>
    {% endfor %}

    <p><strong>–ò—Ç–æ–≥–æ –ø–æ –∑–∞–∫–∞–∑—É:</strong> {{ order.total_price }} ‚ÇΩ</p>
</div>

<!-- –û–ü–õ–ê–¢–ê -->
<div class="card">
    <h3>–û–ø–ª–∞—Ç–∞</h3>

    <p><strong>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</strong>
        {% if payment.method == "card" %}
            üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
        {% elif payment.method == "invoice" %}
            üßæ –ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–π —Ä–∞—Å—á—ë—Ç –ø–æ —Å—á—ë—Ç—É
        {% elif payment.method == "cash" %}
            üíµ –ù–∞–ª–∏—á–Ω—ã–µ –∫—É—Ä—å–µ—Ä—É
        {% else %}
            {{ payment.method }}
        {% endif %}
    </p>

    <p>
        <strong>–°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞:</strong>
        {% if payment.status == "pending" %}
            üïí –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
        {% elif payment.status == "success" %}
            ‚úÖ –û–ø–ª–∞—á–µ–Ω–æ
        {% elif payment.status == "failed" %}
            ‚ùå –û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã
        {% endif %}
    </p>

    {% if payment.method == "invoice" and payment.status == "pending" %}
        <form method="POST"
              action="{{ url_for('main.admin_confirm_payment', order_id=order.id) }}">
            <button class="btn btn-success">
                ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É –ø–æ —Å—á—ë—Ç—É
            </button>
        </form>
    {% endif %}
</div>

<a class="btn btn-secondary"
   href="{{ url_for('main.admin_orders') }}">
    ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –∑–∞–∫–∞–∑–æ–≤
</a>

{% endblock %}
